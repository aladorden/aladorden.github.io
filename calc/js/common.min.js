function init(){var t=new ymaps.Map("map",{center:[55.75,37.64],zoom:11,type:"yandex#map",controls:[]}),e=new ymaps.control.SearchControl({options:{useMapBounds:!0,noPlacemark:!0,noPopup:!0,placeholderContent:"Адрес начальной точки",size:"large"}}),a=new ymaps.control.SearchControl({options:{useMapBounds:!0,noCentering:!0,noPopup:!0,noPlacemark:!0,placeholderContent:"Адрес конечной точки",size:"large",float:"none",position:{right:10,top:10}}}),o=new DeliveryCalculator(t);t.controls.add(e),t.controls.add(a),e.events.add("resultselect",function(t){var a=e.getResultsArray()[t.get("index")].geometry.getCoordinates();o.setStartPoint(a)}).add("load",function(t){!t.get("skip")&&e.getResultsCount()&&e.showResult(0)}),a.events.add("resultselect",function(t){var e=a.getResultsArray()[t.get("index")].geometry.getCoordinates();o.setFinishPoint(e)}).add("load",function(t){!t.get("skip")&&a.getResultsCount()&&a.showResult(0)})}function DeliveryCalculator(t){this._map=t,this._start=null,this._route=null,this._startBalloon,this._finishBalloon,t.events.add("click",this._onClick,this)}$(function(){setInterval(function(){$(".owl-carousel").owlCarousel({loop:!0,nav:!0,items:1,navText:!1})},50),$('select, input[type="number"]').styler(),$("#phone").inputmask({showMaskOnHover:!1}),$("#name").inputmask({showMaskOnHover:!1}),$('[data-toggle="datepicker"]').datepicker({language:"ru-RU"}),$("#basicExample").timepicker({timeFormat:"H:i"})});var ptp=DeliveryCalculator.prototype;ptp._onClick=function(t){this._start?this.setFinishPoint(t.get("coords")):this.setStartPoint(t.get("coords"))},ptp._onStartDragEnd=function(t){var e=this._start.geometry.getCoordinates();this.geocode("start",e)},ptp._onFinishDragEnd=function(t){var e=this._finish.geometry.getCoordinates();this.geocode("finish",e)},ptp.getDirection=function(){if(this._route&&this._map.geoObjects.remove(this._route),this._start&&this._finish){var t=this,e=this._start.geometry.getCoordinates(),a=this._finish.geometry.getCoordinates(),o=this._startBalloon,n=this._finishBalloon;ymaps.route([e,a]).then(function(e){var a=Math.round(e.getLength()/1e3),s="<span>Расстояние: "+a+'км.</span><br/><span style="font-weight: bold; font-style: italic">Стоимость доставки: %sр.</span>';t._route=e.getPaths(),t._route.options.set({strokeWidth:5,strokeColor:"0000ffff",opacity:.5}),t._map.geoObjects.add(t._route),t._start.properties.set("balloonContentBody",o+s.replace("%s",t.calculate(a))),t._finish.properties.set("balloonContentBody",n+s.replace("%s",t.calculate(a))),t._finish.balloon.open()}),t._map.setBounds(t._map.geoObjects.getBounds())}},ptp.setStartPoint=function(t){this._start?this._start.geometry.setCoordinates(t):(this._start=new ymaps.Placemark(t,{iconContent:"А"},{draggable:!0}),this._start.events.add("dragend",this._onStartDragEnd,this),this._map.geoObjects.add(this._start)),this.geocode("start",t)},ptp.setFinishPoint=function(t){this._finish?this._finish.geometry.setCoordinates(t):(this._finish=new ymaps.Placemark(t,{iconContent:"Б"},{draggable:!0}),this._finish.events.add("dragend",this._onFinishDragEnd,this),this._map.geoObjects.add(this._finish)),this._start&&this.geocode("finish",t)},ptp.geocode=function(t,e){ymaps.geocode(e).then(function(e){"start"==t?(this._startBalloon=e.geoObjects.get(0)&&e.geoObjects.get(0).properties.get("balloonContentBody")||"",console.log(t+" "+this._startBalloon)):(this._finishBalloon=e.geoObjects.get(0)&&e.geoObjects.get(0).properties.get("balloonContentBody")||"",console.log(t+" "+this._finishBalloon)),this.getDirection()},this)},ptp.calculate=function(t){return Math.max(20*t,500)},ymaps.ready(init),$(document).ready(function(){$(".dop-param-part").on("change",function(t){$time_loaders=$("#time-loaders").val(),$box_big=$("#box-big").val(),$box_small=$("#box-small").val(),$membrane=$("#membrane").val(),$membrane_str=$("#membrane-str").val(),$cardboard=$("#cardboard").val(),$scotch=$("#scotch").val(),$counters=$(".loaders__count input").val(),$time_ld_pr=$("#time-loaders").attr("data-loads_time")*$time_loaders,$box_bg_pr=$("#box-big").attr("data-box_bg")*$box_big,$box_sm_pr=$("#box-small").attr("data-box_sm")*$box_small,$membrane_pr=$("#membrane").attr("data-membr")*$membrane,$membrane_str_pr=$("#membrane-str").attr("data-membr-str")*$membrane_str,$cardboard_pr=$("#cardboard").attr("data-cardb")*$cardboard,$scotch_pr=$("#scotch").attr("data-scotch")*$scotch,$counters_pr=$(".loaders__count input").attr("data-ld")*$counters,$final_price=parseInt($time_ld_pr)+parseInt($box_bg_pr)+parseInt($box_sm_pr)+parseInt($membrane_pr)+parseInt($membrane_str_pr)+parseInt($cardboard_pr)+parseInt($scotch_pr),$(".ld-time-final .value").text($time_loaders),$(".box-bg-final .value").text($box_big),$(".box-sm-final .value").text($box_small),$(".membrane-final .value").text($membrane),$(".membrane-str-final .value").text($membrane_str),$(".cardboard-final .value").text($cardboard),$(".scotch-final .value").text($scotch),$(".loaders-final .value").text($counters),$time_loaders>0?$(".ld-time-final").show():$(".ld-time-final").hide(),$box_big>0?$(".box-bg-final").show():$(".box-bg-final").hide(),$box_small>0?$(".box-sm-final").show():$(".box-sm-final").hide(),$membrane>0?$(".membrane-final").show():$(".membrane-final").hide(),$membrane_str>0?$(".membrane-str-final").show():$(".membrane-str-final").hide(),$cardboard>0?$(".cardboard-final").show():$(".cardboard-final").hide(),$scotch>0?$(".scotch-final").show():$(".scotch-final").hide(),$(".final-price .value").text($final_price)}),$(".btn-car").one("click",function(){$("div.owl-item.active .car-title span").clone().appendTo(".auto-final .value")}),$(".btn-check").click(function(){$(".ymaps h3").clone().appendTo(".loaders-final .value")})});