$(function(){function t(t){this._map=t,this._start=null,this._route=null,this._startBalloon,this._finishBalloon,t.events.add("click",this._onClick,this)}$(".owl-carousel").owlCarousel({loop:!0,nav:!0,items:1,navText:!1}),$('select, input[type="number"]').styler(),$("#phone").inputmask({showMaskOnHover:!1}),$("#name").inputmask({showMaskOnHover:!1}),$("#phone1").inputmask({showMaskOnHover:!1}),$("#name1").inputmask({showMaskOnHover:!1}),$('[data-toggle="datepicker"]').datepicker({}),$("#basicExample").timepicker({timeFormat:"H:i"});var a=t.prototype;a._onClick=function(t){this._start?this.setFinishPoint(t.get("coords")):this.setStartPoint(t.get("coords"))},a._onStartDragEnd=function(t){var a=this._start.geometry.getCoordinates();this.geocode("start",a)},a._onFinishDragEnd=function(t){var a=this._finish.geometry.getCoordinates();this.geocode("finish",a)},a.getDirection=function(){if(this._route&&this._map.geoObjects.remove(this._route),this._start&&this._finish){var t=this,a=this._start.geometry.getCoordinates(),e=this._finish.geometry.getCoordinates(),o=this._startBalloon,s=this._finishBalloon;ymaps.route([a,e]).then(function(a){var e=Math.round(a.getLength()/1e3),r="<span>Расстояние: "+e+'км.</span><br/><span class="pricerout" style="font-weight: bold; font-style: italic">Стоимость доставки: <span class="pricedost">%s</span>р.</span>';t._route=a.getPaths(),t._route.options.set({strokeWidth:5,strokeColor:"0000ffff",opacity:.5}),t._map.geoObjects.add(t._route),t._start.properties.set("balloonContentBody",o+r.replace("%s",t.calculate(e))),t._finish.properties.set("balloonContentBody",s+r.replace("%s",t.calculate(e))),t._finish.balloon.open()}),t._map.setBounds(t._map.geoObjects.getBounds())}},a.setStartPoint=function(t){this._start?this._start.geometry.setCoordinates(t):(this._start=new ymaps.Placemark(t,{iconContent:"А"},{draggable:!0}),this._start.events.add("dragend",this._onStartDragEnd,this),this._map.geoObjects.add(this._start)),this.geocode("start",t)},a.setFinishPoint=function(t){this._finish?this._finish.geometry.setCoordinates(t):(this._finish=new ymaps.Placemark(t,{iconContent:"Б"},{draggable:!0}),this._finish.events.add("dragend",this._onFinishDragEnd,this),this._map.geoObjects.add(this._finish)),this._start&&this.geocode("finish",t)},a.geocode=function(t,a){ymaps.geocode(a).then(function(a){"start"==t?(this._startBalloon=a.geoObjects.get(0)&&a.geoObjects.get(0).properties.get("balloonContentBody")||"",console.log(t+" "+this._startBalloon),$(".route-final .start").html(this._startBalloon)):(this._finishBalloon=a.geoObjects.get(0)&&a.geoObjects.get(0).properties.get("balloonContentBody")||"",console.log(t+" "+this._finishBalloon),$(".route-final .finish").html(this._finishBalloon)),this.getDirection()},this)},a.calculate=function(t){return Math.max(200*t,500)},ymaps.ready(function(){var a=new ymaps.Map("map",{center:[55.75,37.64],zoom:11,type:"yandex#map",controls:[]}),e=new ymaps.control.SearchControl({options:{useMapBounds:!0,noPlacemark:!0,noPopup:!0,placeholderContent:"Адрес начальной точки",size:"large"}}),o=new ymaps.control.SearchControl({options:{useMapBounds:!0,noCentering:!0,noPopup:!0,noPlacemark:!0,placeholderContent:"Адрес конечной точки",size:"large",float:"none",position:{right:10,top:10}}}),s=new t(a);a.controls.add(e),a.controls.add(o),e.events.add("resultselect",function(t){var a=e.getResultsArray()[t.get("index")].geometry.getCoordinates();s.setStartPoint(a)}).add("load",function(t){!t.get("skip")&&e.getResultsCount()&&e.showResult(0)}),o.events.add("resultselect",function(t){var a=o.getResultsArray()[t.get("index")].geometry.getCoordinates();s.setFinishPoint(a)}).add("load",function(t){!t.get("skip")&&o.getResultsCount()&&o.showResult(0)})}),$(document).ready(function(){$(".btn-map").click(function(){$(".part-map").hide(),$(".part-car").show(),$(".st-2, .arr-1, .arr-2").addClass("active")}),$(".btn-car").click(function(){$(".part-car").hide(),$(".dop-param-part").show(),$(".start p").remove(),$(".finish p").remove(),$(".st-3, .arr-2").addClass("active"),$(".arr-2").addClass("active-1")}),$(".st-1").click(function(){$(".dop-param-part, .accept-part, .accept-later, .part-car").hide(),$(".part-map").show(),$(".start p").remove(),$(".finish p").remove(),$(".st-2, .arr-1, .arr-2").removeClass("active"),$(".arr-2").removeClass("active-1"),$(".st-3").removeClass("active")}),$(".st-2").click(function(){$(".dop-param-part, .accept-part, .accept-later, .part-map").hide(),$(".part-car").show(),$(".start p").remove(),$(".finish p").remove(),$(".st-2, .arr-1, .arr-2").addClass("active"),$(".arr-2").removeClass("active-1"),$(".st-3").removeClass("active")}),$(".st-3").click(function(){$(".part-car, .accept-part, .accept-later, .part-map").hide(),$(".dop-param-part").show(),$(".start p").remove(),$(".finish p").remove(),$(".st-2, .arr-1, .arr-2").addClass("active"),$(".st-3, .arr-2").addClass("active"),$(".arr-2").addClass("active-1")}),$(".btn-acc").click(function(){$(".dop-param-part").hide(),$(".accept-part-1").show()}),$(".btn-later").click(function(){$(".accept-part-1").hide(),$(".accept-later").show()}),$(".btn-before").click(function(){$(".accept-later").hide(),$(".accept-part-1").show()}),$(".btn-map").on("click",function(){$price_rout=$(".pricedost").text(),$(".final-price .value").text($price_rout)});var t=new function(){this.loaders_count=1,this.setLoadersCount=function(t){this.loaders_count=t,this.buildSummary()},this.buildSummary=function(){var t="";$pr_ld=t+=+this.loaders_count,$(".summary__list .loaders-final .value").text($pr_ld)}};$(".loaders__count input").on("change",function(a){var e=$(this)[0];t.setLoadersCount(parseInt($(e).val()))}),$(".dop-param-part").on("change",function(t){$time_loaders=$("#time-loaders").val(),$box_big=$("#box-big").val(),$box_small=$("#box-small").val(),$membrane=$("#membrane").val(),$membrane_str=$("#membrane-str").val(),$cardboard=$("#cardboard").val(),$scotch=$("#scotch").val(),$time_ld_pr=$("#time-loaders").attr("data-loads_time")*$time_loaders,$box_bg_pr=$("#box-big").attr("data-box_bg")*$box_big,$box_sm_pr=$("#box-small").attr("data-box_sm")*$box_small,$membrane_pr=$("#membrane").attr("data-membr")*$membrane,$membrane_str_pr=$("#membrane-str").attr("data-membr-str")*$membrane_str,$cardboard_pr=$("#cardboard").attr("data-cardb")*$cardboard,$scotch_pr=$("#scotch").attr("data-scotch")*$scotch,$final_price=parseInt($price_rout)+parseInt($time_ld_pr)+parseInt($box_bg_pr)+parseInt($box_sm_pr)+parseInt($membrane_pr)+parseInt($membrane_str_pr)+parseInt($cardboard_pr)+parseInt($scotch_pr),$(".ld-time-final .value").text($time_loaders),$(".box-bg-final .value").text($box_big),$(".box-sm-final .value").text($box_small),$(".membrane-final .value").text($membrane),$(".membrane-str-final .value").text($membrane_str),$(".cardboard-final .value").text($cardboard),$(".scotch-final .value").text($scotch),$time_loaders>0?$(".ld-time-final").show():$(".ld-time-final").hide(),$box_big>0?$(".box-bg-final").show():$(".box-bg-final").hide(),$box_small>0?$(".box-sm-final").show():$(".box-sm-final").hide(),$membrane>0?$(".membrane-final").show():$(".membrane-final").hide(),$membrane_str>0?$(".membrane-str-final").show():$(".membrane-str-final").hide(),$cardboard>0?$(".cardboard-final").show():$(".cardboard-final").hide(),$scotch>0?$(".scotch-final").show():$(".scotch-final").hide(),$(".final-price .value").text($final_price)}),$(".start").remove("p")}),$(".btn-check").on("click",function(){var t=$("div.owl-item.active .car-title span").text();$(".auto-final .value").text(t)})});